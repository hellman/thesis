{
  \renewcommand\arraystretch{0.9}
  \setlength{\tabcolsep}{2pt}
  \begin{figure}
    \begin{subfigure}{0.32\textwidth}
    \centering
    {
        \newcommand\myrect[5]{\draw (#1,#2) rectangle ({#1+#3},{#2+#4}) node[pos=0.5] {#5} ; }
        \newcommand\minicipher[3]{
        	\myrect{#1}{#2}{1}{1}{#3}
            \draw (#1+1, #2+0.3) -- (#1+1-0.15, #2+0.5) -- (#1+1, #2+1-0.3) ;
        }
        %   \vspace{18pt}
          \begin{tikzpicture}[xscale=1.0, yscale=-0.7]
        	\if0
        	    \draw[help lines,dotted] (-2,-3) grid (2,3);
        		\foreach \x in {-2,-1,0,1,2}
        		    \draw (\x cm,-1pt) node[anchor=north] {\color{gray} \tiny $\x$};
        		\foreach \y in {-3,-2,-1,1,2,3}
        		    \draw (+3pt,\y-0.05) node[anchor=east] {\color{gray} \tiny $\y$};
        	\fi
        
            % Mini block ciphers
        	\minicipher{-1.5}{-2}{$T$}
        	\minicipher{-1.5}{+0.5}{$U$}
        
            \draw [->] (-1,-3) -- (-1,-2);
            \draw      (-1,-1) -- (-1,-0.5) -- (1,0) -- (1,2.5);
        	\draw [->] (1,1) -- (-0.5,1);
        
        	\draw [->] (1,-3) -- (1,-0.5) -- (-1,0) -- (-1,0.5);
        	\draw [->] (1,-1.5) -- (-0.5,-1.5);
        	\draw      (-1,1.5) -- (-1,2.5);
          \end{tikzpicture}
          \vspace{10pt}
          \caption{TU-decomposition}
    }
    \end{subfigure}
    \begin{subfigure}{0.32\textwidth}
      \begin{tabular}{l|rrrrrrrr}
& $\hex{0}$ & $\hex{1}$ & $\hex{2}$ & $\hex{3}$ & $\hex{4}$ & $\hex{5}$ & $\hex{6}$ & $\hex{7}$\\
        \hline
$T_{\hex{0}}$ & $\hex{0}$ & $\hex{6}$ & $\hex{4}$ & $\hex{7}$ & $\hex{3}$ & $\hex{1}$ & $\hex{5}$ & $\hex{2}$\\
$T_{\hex{1}}$ & $\hex{7}$ & $\hex{5}$ & $\hex{1}$ & $\hex{6}$ & $\hex{4}$ & $\hex{2}$ & $\hex{0}$ & $\hex{3}$\\
$T_{\hex{2}}$ & $\hex{4}$ & $\hex{3}$ & $\hex{2}$ & $\hex{0}$ & $\hex{5}$ & $\hex{6}$ & $\hex{1}$ & $\hex{7}$\\
$T_{\hex{3}}$ & $\hex{3}$ & $\hex{5}$ & $\hex{2}$ & $\hex{1}$ & $\hex{4}$ & $\hex{6}$ & $\hex{7}$ & $\hex{0}$\\
$T_{\hex{4}}$ & $\hex{1}$ & $\hex{2}$ & $\hex{0}$ & $\hex{6}$ & $\hex{4}$ & $\hex{3}$ & $\hex{7}$ & $\hex{5}$\\
$T_{\hex{5}}$ & $\hex{6}$ & $\hex{5}$ & $\hex{2}$ & $\hex{4}$ & $\hex{7}$ & $\hex{0}$ & $\hex{1}$ & $\hex{3}$\\
$T_{\hex{6}}$ & $\hex{5}$ & $\hex{2}$ & $\hex{6}$ & $\hex{4}$ & $\hex{0}$ & $\hex{3}$ & $\hex{1}$ & $\hex{7}$\\
$T_{\hex{7}}$ & $\hex{2}$ & $\hex{0}$ & $\hex{1}$ & $\hex{6}$ & $\hex{5}$ & $\hex{3}$ & $\hex{4}$ & $\hex{7}$\\
      \end{tabular}
      \caption{$T$}
    \end{subfigure}
    \begin{subfigure}{0.32\textwidth}
      \centering
      \begin{tabular}{l|rrrrrrrr}
& $\hex{0}$ & $\hex{1}$ & $\hex{2}$ & $\hex{3}$ & $\hex{4}$ & $\hex{5}$ & $\hex{6}$ & $\hex{7}$\\
        \hline
$U_{\hex{0}}$ & $\hex{0}$ & $\hex{3}$ & $\hex{6}$ & $\hex{4}$ & $\hex{2}$ & $\hex{7}$ & $\hex{1}$ & $\hex{5}$\\
$U_{\hex{1}}$ & $\hex{7}$ & $\hex{4}$ & $\hex{0}$ & $\hex{2}$ & $\hex{3}$ & $\hex{6}$ & $\hex{1}$ & $\hex{5}$\\
$U_{\hex{2}}$ & $\hex{1}$ & $\hex{4}$ & $\hex{2}$ & $\hex{6}$ & $\hex{3}$ & $\hex{0}$ & $\hex{5}$ & $\hex{7}$\\
$U_{\hex{3}}$ & $\hex{7}$ & $\hex{2}$ & $\hex{5}$ & $\hex{1}$ & $\hex{3}$ & $\hex{0}$ & $\hex{4}$ & $\hex{6}$\\
$U_{\hex{4}}$ & $\hex{7}$ & $\hex{3}$ & $\hex{4}$ & $\hex{1}$ & $\hex{0}$ & $\hex{2}$ & $\hex{6}$ & $\hex{5}$\\
$U_{\hex{5}}$ & $\hex{3}$ & $\hex{7}$ & $\hex{1}$ & $\hex{4}$ & $\hex{2}$ & $\hex{0}$ & $\hex{5}$ & $\hex{6}$\\
$U_{\hex{6}}$ & $\hex{1}$ & $\hex{3}$ & $\hex{7}$ & $\hex{4}$ & $\hex{6}$ & $\hex{2}$ & $\hex{5}$ & $\hex{0}$\\
$U_{\hex{7}}$ & $\hex{4}$ & $\hex{6}$ & $\hex{3}$ & $\hex{0}$ & $\hex{5}$ & $\hex{1}$ & $\hex{7}$ & $\hex{2}$\\
      \end{tabular}
      \caption{$U$}
    \end{subfigure}
  \FigDef{tu}{The TU-decomposition of $\eta^{\top} \circ S_0$.}  
  \end{figure}
}