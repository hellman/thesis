\IfFileExists{figures/cbc.pdf}{
\includegraphics[height=\HEIGHT]{figures/cbc.pdf}
}{
    \begin{tikzpicture}
    
            \foreach \x in {0, 1, 2} {
                \node (f\x) at ($\x*(2.5cm,0)$) [minimum size=1.25cm,rounded corners=1ex,fill=red!20,draw] {E};
                \node (p\x) [above of=f\x, node distance=1.5cm, circle, draw] {};
                \node (m\x) [above of=p\x, node distance=1cm] {$m_\x$};
                \node (k\x) [left of=f\x, node distance=1.5cm] {$k$};
                \node (c\x) [below of=f\x, node distance=1.5cm] {$c_\x$};
                \draw[-] (p\x.north) -- (p\x.south);
                \draw[-] (p\x.east) -- (p\x.west);
                \draw[-latex] (m\x) -- (p\x);
                \draw[-latex] (p\x) -- (f\x);
                \draw[-latex] (k\x) -- (f\x);
                \draw[-latex] (f\x) -- (c\x);
            }
            \node (iv) [left of=p0, node distance=1.5cm] {$IV$};
            \draw[-latex] (iv) -- (p0);
    
            \foreach \x in {0, 1} {
            \draw[-latex] ($(c\x) + (0,0.6cm)$) -| +(0.8cm,2.4cm) -- ($(p\x) + (2.4cm,0)$);
    
            \begin{scope}
                \node at (6.4,0) {$\cdots$};
            \end{scope}
            }
    
        \end{tikzpicture}
    % \Credit{TikZ for Cryptographers}
}
